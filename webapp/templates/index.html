<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Option Pricing Calculator</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>

<body>
    <div class="container mt-5">
        <h1>Option Pricing Calculator</h1>
        <form method="POST">
            <div class="form-group">
                <label for="S">Stock Price (S):</label>
                <input type="range" class="form-control-range" id="S" name="S" min="1" max="500" step="1"
                    value="{{ S or 100 }}">
                <span id="S_value">{{ S or 100 }}</span>
            </div>
            <div class="form-group">
                <label for="K">Strike Price (K):</label>
                <input type="range" class="form-control-range" id="K" name="K" min="1" max="500" step="1"
                    value="{{ K or 100 }}">
                <span id="K_value">{{ K or 100 }}</span>
            </div>
            <div class="form-group">
                <label for="T">Time to Maturity (T in years):</label>
                <input type="range" class="form-control-range" id="T" name="T" min="0.01" max="2" step="0.01"
                    value="{{ T or 1 }}">
                <span id="T_value">{{ T or 1 }}</span>
            </div>
            <div class="form-group">
                <label for="r">Risk-Free Rate (r):</label>
                <input type="range" class="form-control-range" id="r" name="r" min="0" max="0.2" step="0.001"
                    value="{{ r or 0.05 }}">
                <span id="r_value">{{ r or 0.05 }}</span>
            </div>
            <div class="form-group">
                <label for="sigma">Volatility (Ïƒ):</label>
                <input type="range" class="form-control-range" id="sigma" name="sigma" min="0.01" max="1" step="0.01"
                    value="{{ sigma or 0.2 }}">
                <span id="sigma_value">{{ sigma or 0.2 }}</span>
            </div>
            <div class="form-group">
                <label for="option_type">Option Type:</label>
                <select class="form-control" id="option_type" name="option_type">
                    <option value="c" {% if option_type=='c' %}selected{% endif %}>Call</option>
                    <option value="p" {% if option_type=='p' %}selected{% endif %}>Put</option>
                </select>
            </div>
            <button type="submit" class="btn btn-primary">Calculate</button>
        </form>

        {% if option_price is not none %}
        <h3>Results:</h3>
        <p><strong>Option Price:</strong> {{ option_price }}</p>
        <p><strong>Implied Volatility:</strong> {{ iv }}</p>
        <h4>Greeks:</h4>
        <ul>
            {% for greek, value in greeks.items() %}
            <li><strong>{{ greek }}:</strong> {{ value }}</li>
            {% endfor %}
        </ul>
        {% endif %}
    </div>

    <script>
        // Update slider values in real-time
        document.querySelectorAll('input[type="range"]').forEach(slider => {
            slider.addEventListener('input', event => {
                document.getElementById(`${event.target.id}_value`).textContent = event.target.value;
            });
        });
    </script>
</body>

</html>